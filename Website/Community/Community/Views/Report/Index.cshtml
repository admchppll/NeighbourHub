@model PagedList.IPagedList<Community.Models.Report>
@using PagedList.Mvc;
@using Community.Helpers;
@{
    ViewBag.Title = "Reports";
}

<h2>Reports</h2>

<ul class="nav nav-pills nav-justified">
    <li class="@(ViewBag.Section == "index"?"active":"")"><a href="@Url.Action("Index")">All Reports <span class="badge">@ReportHelper.getUnresolved()</span></a></li>
    <li class="@(ViewBag.Section == "event"?"active":"")"><a href="@Url.Action("Index", new { section = "event"})">Event Reports <span class="badge">@ReportHelper.getUnresolvedEvent()</span></a></li>
    <li class="@(ViewBag.Section == "user"?"active":"")"><a href="@Url.Action("Index", new { section = "user"})">User Reports <span class="badge">@ReportHelper.getUnresolvedUser()</span></a></li>
</ul>
<input type="hidden" name="showHidden" value="@ViewBag.ShowResolved"/>
<div id="resolvedLink">
    @if (ViewBag.ShowResolved == false)
    {
        @Html.ActionLink("Show Resolved", "Index", new { section = ViewBag.Section, showResolved = !ViewBag.ShowResolved })
    }
    else {
        @Html.ActionLink("Hide Resolved", "Index", new { section = ViewBag.Section, showResolved = !ViewBag.ShowResolved })
    }
</div>
<table class="table">
    <tr>
        <th></th>
        <th>
            ID
        </th>
        <th>
            Reported Event
        </th>
        <th>
            Reported User
        </th>
        <th>
            Reported By
        </th>
        @if (ViewBag.ShowResolved == true)
        {
        <th>
            Resolved
        </th>
        }
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @if (item.ReportedEvent != null && item.ReportedID == null)
            {
                <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
            }
            else if (item.ReportedEvent == null && item.ReportedID != null)
            {
                <span class="glyphicon glyphicon-glyphicon-user" aria-hidden="true"></span>
            }

        </td>
        <td>
            @Html.ActionLink(item.ID.ToString(), "Details", new { id = item.ID })
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Event.Title)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.User.Email)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.User1.UserName)
        </td>
        @if (ViewBag.ShowResolved == true)
        {
        <td>
            @Html.DisplayFor(modelItem => item.Resolved, "YesNo")
        </td>
        }
        <td>
            @Html.ActionLink("View", "Details", new { id=item.ID })
        </td>
    </tr>
}
</table>
<div class="pagerSection">
    @Html.PagedListPager(Model, page => Url.Action("Index",
        new { page, sortOrder = ViewBag.CurrentSort }))
</div>